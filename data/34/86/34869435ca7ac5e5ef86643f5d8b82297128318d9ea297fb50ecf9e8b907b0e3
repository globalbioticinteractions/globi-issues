[{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2233974697","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/995#issuecomment-2233974697","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/995","id":2233974697,"node_id":"IC_kwDOACXQt86FJ7-p","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-17T18:24:32Z","updated_at":"2024-07-17T18:25:07Z","body":"downgrading to v0.5.1 does not appear to solve the issue of premature stopping of taxonomic name indexing. \r\n\r\n```\r\nJul 17 15:41:11  [main] INFO org.eol.globi.util.NodeProcessorImpl - collected 954331 [taxons] no>\r\nJul 17 15:41:11 [main] INFO org.eol.globi.util.NodeProcessorImpl - processing 954331 [taxons] n>\r\nJul 17 17:22:01 [INFO] ------------------------------------------------------------------------\r\nJul 17 17:22:01 [INFO] BUILD FAILURE\r\nJul 17 17:22:01 [INFO] ------------------------------------------------------------------------\r\nJul 17 17:22:01 [INFO] Total time:  22:32 h\r\nJul 17 17:22:01 [INFO] Finished at: 2024-07-17T17:22:01+02:00\r\nJul 17 17:22:01 [INFO] ------------------------------------------------------------------------\r\n```\r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2233974697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2234004354","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/995#issuecomment-2234004354","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/995","id":2234004354,"node_id":"IC_kwDOACXQt86FKDOC","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-17T18:40:45Z","updated_at":"2024-07-17T18:41:33Z","body":"so, the upgrade in taxonomic graph doesn't appear to be an issue. \r\n\r\nAnother source could be limited resources. On the indexing machine, the resources are shared with a neo4j instance, possibly starving the indexing process of much needed resources. Or, alternatively, reduce the number of datasets indexed .\r\n\r\n![image](https://github.com/user-attachments/assets/a44bc906-432b-4a13-90a9-5daaa301d9fe)\r\n\r\nSuggested next step - run the indexing model in a more memory rich environment.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2234004354/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2237016743","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/995#issuecomment-2237016743","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/995","id":2237016743,"node_id":"IC_kwDOACXQt86FViqn","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-18T16:20:30Z","updated_at":"2024-07-18T16:20:30Z","body":"I've just started an indexing run on a separate system with more available memory to verify that the root cause of the abrupt stopping of the indexing process was due to a memory shortage.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2237016743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2239740388","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/995#issuecomment-2239740388","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/995","id":2239740388,"node_id":"IC_kwDOACXQt86Ff7nk","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-19T17:39:26Z","updated_at":"2024-07-19T17:39:26Z","body":"On monitoring the neo4j debug.log of the indexing process, the following line was seen:\r\n\r\n> 2024-07-19 17:35:01.085+0000 WARN [o.n.i.p.PageCache] The dbms.memory.pagecache.size setting has not been configured. It is recommended that this setting is always explicitly configured, to ensure the system has a balanced configuration. Until then, a computed heuristic value of 21474836480 bytes will be used instead. Run `neo4j-admin memrec` for memory configuration suggestions.\r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2239740388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2239769466","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/995#issuecomment-2239769466","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/995","id":2239769466,"node_id":"IC_kwDOACXQt86FgCt6","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-19T17:48:09Z","updated_at":"2024-07-19T17:48:09Z","body":"with 32 GB available - the recommendation is:\r\n\r\n```\r\nneo4j-admin memrec --memory 32100m\r\n```\r\n\r\nproduced: \r\n\r\n```\r\nWARNING: Max 1024 open files allowed, minimum of 40000 recommended. See the Neo4j manual.\r\n# Memory settings recommendation from neo4j-admin memrec:\r\n#\r\n# Assuming the system is dedicated to running Neo4j and has 32100m of memory,\r\n# we recommend a heap size of around 12000m, and a page cache of around 12100m,\r\n# and that about 8000m is left for the operating system, and the native memory\r\n# needed by Lucene and Netty.\r\n#\r\n# Tip: If the indexing storage use is high, e.g. there are many indexes or most\r\n# data indexed, then it might advantageous to leave more memory for the\r\n# operating system.\r\n#\r\n# Tip: The more concurrent transactions your workload has and the more updates\r\n# they do, the more heap memory you will need. However, don't allocate more\r\n# than 31g of heap, since this will disable pointer compression, also known as\r\n# \"compressed oops\", in the JVM and make less effective use of the heap.\r\n#\r\n# Tip: Setting the initial and the max heap size to the same value means the\r\n# JVM will never need to change the heap size. Changing the heap size otherwise\r\n# involves a full GC, which is desirable to avoid.\r\n#\r\n# Based on the above, the following memory settings are recommended:\r\ndbms.memory.heap.initial_size=12000m\r\ndbms.memory.heap.max_size=12000m\r\ndbms.memory.pagecache.size=12100m\r\n```\r\n\r\nfor the default on the server (64GB) - \r\n\r\n```\r\nneo4j-admin memrec\r\nWARNING: Max 1024 open files allowed, minimum of 40000 recommended. See the Neo4j manual.\r\n# Memory settings recommendation from neo4j-admin memrec:\r\n#\r\n# Assuming the system is dedicated to running Neo4j and has 64200m of memory,\r\n# we recommend a heap size of around 24100m, and a page cache of around 28000m,\r\n# and that about 12100m is left for the operating system, and the native memory\r\n# needed by Lucene and Netty.\r\n#\r\n# Tip: If the indexing storage use is high, e.g. there are many indexes or most\r\n# data indexed, then it might advantageous to leave more memory for the\r\n# operating system.\r\n#\r\n# Tip: The more concurrent transactions your workload has and the more updates\r\n# they do, the more heap memory you will need. However, don't allocate more\r\n# than 31g of heap, since this will disable pointer compression, also known as\r\n# \"compressed oops\", in the JVM and make less effective use of the heap.\r\n#\r\n# Tip: Setting the initial and the max heap size to the same value means the\r\n# JVM will never need to change the heap size. Changing the heap size otherwise\r\n# involves a full GC, which is desirable to avoid.\r\n#\r\n# Based on the above, the following memory settings are recommended:\r\ndbms.memory.heap.initial_size=24100m\r\ndbms.memory.heap.max_size=24100m\r\ndbms.memory.pagecache.size=28000m\r\n```","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2239769466/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2239786040","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/995#issuecomment-2239786040","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/995","id":2239786040,"node_id":"IC_kwDOACXQt86FgGw4","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-19T17:51:23Z","updated_at":"2024-07-19T17:51:23Z","body":"Note that the current system has two neo4j instances running - one dedicated to read-only queries, the other for indexing. Having both be tuned to using all memory on the system may cause resource starvation by configuration. ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2239786040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2241146491","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/995#issuecomment-2241146491","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/995","id":2241146491,"node_id":"IC_kwDOACXQt86FlS57","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-20T13:03:42Z","updated_at":"2024-07-20T13:03:42Z","body":"> I've just started an indexing run on a separate system with more available memory to verify that the root cause of the abrupt stopping of the indexing process was due to a memory shortage.\r\n\r\nthe system fully dedicated to indexing was able to successfully build a version of the GloBI index. However, the existing system did not, even after excluding a dataset with many names from the index (ie.g. Mycoportal IPT). This is consistent with that an unbalanced memory configuration is the cause of the abrupt stopping (with error code 137) of the indexing process.\r\n\r\nNow, rerunning both dedicated and shared systems with introduced pagecache memory size configuration introduced via https://github.com/globalbioticinteractions/globalbioticinteractions/commit/99caa0e4a5b02eae085520da0f4e9e1551ca8405 . ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2241146491/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2241641667","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/995#issuecomment-2241641667","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/995","id":2241641667,"node_id":"IC_kwDOACXQt86FnLzD","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-21T15:05:19Z","updated_at":"2024-07-21T15:21:58Z","body":"it appears that the original system (with indexer shared with other services) was able to complete the indexing successfully after setting the page cache size explicitly. \r\n\r\n\r\n```\r\nJul 21 07:54:35 INFO org.eol.globi.util.NodeProcessorImpl - processing 945052 [taxons] nodes...\r\nJul 21 12:29:17 INFO org.eol.globi.util.NodeProcessorImpl - processed 945052 [taxons] nodes in 16501s (@ 0 nodes/ms)\r\nJul 21 12:29:17 INFO org.eol.globi.tool.IndexerTimed - LinkerTaxonIndexNeo4j2 completed in [16502]s\r\nJul 21 12:29:18 INFO org.eol.globi.db.GraphServiceFactoryImpl - neo4j stopping...\r\nJul 21 12:29:18 INFO org.eol.globi.db.GraphServiceFactoryImpl - done.\r\nJul 21 12:29:18 INFO org.eol.globi.db.GraphServiceFactoryImpl - neo4j stopping...\r\nJul 21 12:29:18 INFO org.eol.globi.db.GraphServiceFactoryImpl - done.\r\nJul 21 12:29:18 INFO org.eol.globi.db.GraphServiceFactoryImpl - neo4j stopping...\r\nJul 21 12:29:18 INFO org.eol.globi.db.GraphServiceFactoryImpl - done.\r\nJul 21 12:29:19 [INFO]\r\n[...]\r\nJul 21 12:47:58 Uploading to globi-snapshot: s3://globi/snapshot/org/eol/eol-globi-datasets/1.1-SNAPSHOT/eol-globi-datasets->\r\nJul 21 12:55:20 Uploading to globi-snapshot: s3://globi/snapshot/org/eol/eol-globi-datasets/1.1-SNAPSHOT/maven-metadata.xml\r\nJul 21 12:55:21 [INFO] ------------------------------------------------------------------------\r\nJul 21 12:55:21 [INFO] BUILD SUCCESS\r\nJul 21 12:55:21 [INFO] ------------------------------------------------------------------------\r\nJul 21 12:55:21 [INFO] Total time:  1 d 02:33 h\r\nJul 21 12:55:21 [INFO] Finished at: 2024-07-21T12:55:21+02:00\r\n```","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2241641667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2241693598","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/995#issuecomment-2241693598","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/995","id":2241693598,"node_id":"IC_kwDOACXQt86FnYee","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-21T15:47:03Z","updated_at":"2024-07-21T15:47:03Z","body":"A newly rebuilt index was just released, suggesting that the premature termination of the indexing process is no longer occurring after explicitly setting the page size memory for neo4j.\r\n\r\n![image](https://github.com/user-attachments/assets/cd45698e-9665-4e71-8227-0e4f0858234a)\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/2241693598/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]