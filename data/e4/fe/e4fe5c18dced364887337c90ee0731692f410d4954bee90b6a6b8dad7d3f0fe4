[{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/370055055","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/345#issuecomment-370055055","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/345","id":370055055,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDA1NTA1NQ==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-02T21:17:46Z","updated_at":"2018-03-02T21:17:46Z","body":"Hey @ethanwhite - I am not aware of any blocking of user agent. Also, I was unable to reproduce your observations of 403s when downloading the interactions.tsv.gz file. \r\n\r\nPlease provide an isolated python code so I can reproduce the issue.\r\n\r\nThanks!","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/370055055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/370163915","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/345#issuecomment-370163915","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/345","id":370163915,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDE2MzkxNQ==","user":{"login":"ethanwhite","id":744427,"node_id":"MDQ6VXNlcjc0NDQyNw==","avatar_url":"https://avatars.githubusercontent.com/u/744427?v=4","gravatar_id":"","url":"https://api.github.com/users/ethanwhite","html_url":"https://github.com/ethanwhite","followers_url":"https://api.github.com/users/ethanwhite/followers","following_url":"https://api.github.com/users/ethanwhite/following{/other_user}","gists_url":"https://api.github.com/users/ethanwhite/gists{/gist_id}","starred_url":"https://api.github.com/users/ethanwhite/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ethanwhite/subscriptions","organizations_url":"https://api.github.com/users/ethanwhite/orgs","repos_url":"https://api.github.com/users/ethanwhite/repos","events_url":"https://api.github.com/users/ethanwhite/events{/privacy}","received_events_url":"https://api.github.com/users/ethanwhite/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-03T17:15:34Z","updated_at":"2018-03-03T17:15:34Z","body":"Thanks @jhpoelen. Here's code to reproduce, but it doesn't seem to be agent blocking.\r\n\r\n```python\r\nfrom urllib.request import urlretrieve\r\n\r\nurlretrieve(\"https://depot.globalbioticinteractions.org/snapshot/target/data/tsv/interactions.tsv.gz\")\r\n```\r\n\r\nIf I do the same download using `requests` it works:\r\n\r\n```\r\nimport requests\r\n\r\nr = requests.get('https://depot.globalbioticinteractions.org/snapshot/target/data/tsv/interactions.tsv.gz', stream=True)\r\n\r\nwith open('interactions.tsv.gz', 'wb') as f:\r\n    for chunk in r.iter_content():\r\n            f.write(chunk)\r\n```\r\n\r\nso I'm not sure what it is about this particular url that is causing issues using `urllib` (it's the only one out of hundreds that we work with).\r\n\r\nHere's the full traceback for the record, but this seems like it's probably something we should be solving on our end:\r\n\r\n```python\r\nHTTPError                                 Traceback (most recent call last)\r\n<ipython-input-2-5a4a41fecf2b> in <module>()\r\n----> 1 urlretrieve(\"https://depot.globalbioticinteractions.org/snapshot/target/data/tsv/interactions.tsv.gz\")\r\n\r\n~/miniconda3/lib/python3.6/urllib/request.py in urlretrieve(url, filename, reporthook, data)\r\n    246     url_type, path = splittype(url)\r\n    247 \r\n--> 248     with contextlib.closing(urlopen(url, data)) as fp:\r\n    249         headers = fp.info()\r\n    250 \r\n\r\n~/miniconda3/lib/python3.6/urllib/request.py in urlopen(url, data, timeout, cafile, capath, cadefault, context)\r\n    221     else:\r\n    222         opener = _opener\r\n--> 223     return opener.open(url, data, timeout)\r\n    224 \r\n    225 def install_opener(opener):\r\n\r\n~/miniconda3/lib/python3.6/urllib/request.py in open(self, fullurl, data, timeout)\r\n    530         for processor in self.process_response.get(protocol, []):\r\n    531             meth = getattr(processor, meth_name)\r\n--> 532             response = meth(req, response)\r\n    533 \r\n    534         return response\r\n\r\n~/miniconda3/lib/python3.6/urllib/request.py in http_response(self, request, response)\r\n    640         if not (200 <= code < 300):\r\n    641             response = self.parent.error(\r\n--> 642                 'http', request, response, code, msg, hdrs)\r\n    643 \r\n    644         return response\r\n\r\n~/miniconda3/lib/python3.6/urllib/request.py in error(self, proto, *args)\r\n    568         if http_err:\r\n    569             args = (dict, 'default', 'http_error_default') + orig_args\r\n--> 570             return self._call_chain(*args)\r\n    571 \r\n    572 # XXX probably also want an abstract factory that knows when it makes\r\n\r\n~/miniconda3/lib/python3.6/urllib/request.py in _call_chain(self, chain, kind, meth_name, *args)\r\n    502         for handler in handlers:\r\n    503             func = getattr(handler, meth_name)\r\n--> 504             result = func(*args)\r\n    505             if result is not None:\r\n    506                 return result\r\n\r\n~/miniconda3/lib/python3.6/urllib/request.py in http_error_default(self, req, fp, code, msg, hdrs)\r\n    648 class HTTPDefaultErrorHandler(BaseHandler):\r\n    649     def http_error_default(self, req, fp, code, msg, hdrs):\r\n--> 650         raise HTTPError(req.full_url, code, msg, hdrs, fp)\r\n    651 \r\n    652 class HTTPRedirectHandler(BaseHandler):\r\n\r\nHTTPError: HTTP Error 403: Forbidden\r\n```\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/370163915/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/376349877","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/345#issuecomment-376349877","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/345","id":376349877,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjM0OTg3Nw==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-26T23:56:24Z","updated_at":"2018-03-26T23:56:24Z","body":"@ethanwhite Please let me know if it appears to be an issue on our end and I'll re-open the issue. Meanwhile, closing it.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/376349877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/376351819","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/345#issuecomment-376351819","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/345","id":376351819,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjM1MTgxOQ==","user":{"login":"ethanwhite","id":744427,"node_id":"MDQ6VXNlcjc0NDQyNw==","avatar_url":"https://avatars.githubusercontent.com/u/744427?v=4","gravatar_id":"","url":"https://api.github.com/users/ethanwhite","html_url":"https://github.com/ethanwhite","followers_url":"https://api.github.com/users/ethanwhite/followers","following_url":"https://api.github.com/users/ethanwhite/following{/other_user}","gists_url":"https://api.github.com/users/ethanwhite/gists{/gist_id}","starred_url":"https://api.github.com/users/ethanwhite/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ethanwhite/subscriptions","organizations_url":"https://api.github.com/users/ethanwhite/orgs","repos_url":"https://api.github.com/users/ethanwhite/repos","events_url":"https://api.github.com/users/ethanwhite/events{/privacy}","received_events_url":"https://api.github.com/users/ethanwhite/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-27T00:06:42Z","updated_at":"2018-03-27T00:06:42Z","body":"The redirect was causing and issue for Python's `urllib`. We patched it by just using the destination url on S3:\r\n\r\nhttps://github.com/weecology/retriever/pull/1096\r\n\r\nMotivated by this we're going to go ahead and upgrade to using `requests` to avoid these sorts of issues in the future. Thanks for your help debugging. Much appreciated.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/376351819/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]