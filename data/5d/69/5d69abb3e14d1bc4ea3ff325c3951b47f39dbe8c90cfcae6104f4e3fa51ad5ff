[{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/896998961","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/686#issuecomment-896998961","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/686","id":896998961,"node_id":"IC_kwDOACXQt841dx4x","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T17:07:36Z","updated_at":"2021-08-11T17:07:36Z","body":"@bonushenricus thanks for your message. Sorry to hear that the Cypher queries are causing issues - I can see how finding the interaction terms in Cypher land can be challenging, especially because they are slightly different from those documented via https://api.globalbioticinteractions.org/interactionTypes.csv .\r\n\r\nYou can find a list of the supported Cypher interaction terms in:\r\n\r\nhttps://github.com/globalbioticinteractions/globalbioticinteractions/blob/bd16754fcb3bf32e1efa8427d7b02c600430d2bc/eol-globi-lib/src/main/java/org/eol/globi/domain/InteractType.java\r\n\r\nThe terms used in Cypher are the capitalized ones. \r\n\r\nFor instead of:\r\n\r\n```\r\nquery(\"START sourceTaxon = node:taxons(name='Vitis') MATCH sourceTaxon<-[:CLASSIFIED_AS]-source-[:interactsWith]->target-[:CLASSIFIED_AS]->targetTaxon RETURN targetTaxon\")\r\n```\r\n\r\nyou'd say\r\n\r\n```\r\n> rglobi::query(\"START sourceTaxon = node:taxons(name='Vitis') MATCH sourceTaxon<-[:CLASSIFIED_AS]-source-[:INTERACTS_WITH]->target-[:CLASSIFIED_AS]->targetTaxon RETURN targetTaxon.name limit 10\")\r\n        targetTaxon.name\r\n1     Calyptra thalictri\r\n2    Calyptra eustrigata\r\n3  Calyptra ophideroides\r\n4  Calyptra minuticornis\r\n5  Calyptra minuticornis\r\n6         Calyptra parva\r\n7      Calyptra fasciata\r\n8     Calyptra thalictri\r\n9    Calyptra eustrigata\r\n10    Calyptra thalictri\r\n```\r\n\r\nNote that no taxonomic/interaction inferences are made with this query. This means that only interactions with taxon name ```Vitis``` and explicit interaction type ```INTERACTS_WITH``` are selected. If you'd like to include all ```Vitis``` taxa you can use the ```node:taxonPaths('path:Vitis')``` index:\r\n\r\n```\r\n> rglobi::query(\"START sourceTaxon = node:taxonPaths('path:Vitis') MATCH sourceTaxon<-[:CLASSIFIED_AS]-source-[:INTERACTS_WITH]->target-[:CLASSIFIED_AS]->targetTaxon RETURN targetTaxon.name limit 10\")\r\n           targetTaxon.name\r\n1                Aphrophora\r\n2  Diaspidiotus perniciosus\r\n3  Diaspidiotus perniciosus\r\n4                     Aphis\r\n5                     Aphis\r\n6                     Aphis\r\n7             Plagiognathus\r\n8                     Aphis\r\n9                     Aphis\r\n10                    Aphis\r\n\r\n```\r\n\r\nAlso, if you'd like to select more interactions you can say stuff like:\r\n\r\n```\r\n> rglobi::query(\"START sourceTaxon = node:taxonPaths('path:Vitis') MATCH sourceTaxon<-[:CLASSIFIED_AS]-source-[:INTERACTS_WITH|EATEN_BY|HAS_PARASITE]->target-[:CLASSIFIED_AS]->targetTaxon RETURN targetTaxon.name limit 10\")\r\n            targetTaxon.name\r\n1              Darapsa myron\r\n2          Eumorpha pandorus\r\n3                      Geina\r\n4  Phyllocnistis vitegenella\r\n5                 Aphrophora\r\n6   Diaspidiotus perniciosus\r\n7   Diaspidiotus perniciosus\r\n8                      Aphis\r\n9                      Aphis\r\n10                     Aphis\r\n\r\n```\r\n\r\nNote that similar results can be retrieved using:\r\n\r\n```\r\n> head(rglobi::get_interactions(taxon='Vitis', interaction.type='interactsWith')\r\n  source_taxon_external_id source_taxon_name                                  \r\n1             GBIF:5372385     Vitis riparia\r\n2             GBIF:5372385     Vitis riparia\r\n3             GBIF:5372385     Vitis riparia\r\n4             GBIF:5372385     Vitis riparia\r\n5             GBIF:5372385     Vitis riparia\r\n6             GBIF:5372385     Vitis riparia\r\n                                                                    source_taxon_path\r\n1 Plantae | Tracheophyta | Magnoliopsida | Vitales | Vitaceae | Vitis | Vitis riparia\r\n2 Plantae | Tracheophyta | Magnoliopsida | Vitales | Vitaceae | Vitis | Vitis riparia\r\n3 Plantae | Tracheophyta | Magnoliopsida | Vitales | Vitaceae | Vitis | Vitis riparia\r\n4 Plantae | Tracheophyta | Magnoliopsida | Vitales | Vitaceae | Vitis | Vitis riparia\r\n5 Plantae | Tracheophyta | Magnoliopsida | Vitales | Vitaceae | Vitis | Vitis riparia\r\n6 Plantae | Tracheophyta | Magnoliopsida | Vitales | Vitaceae | Vitis | Vitis riparia\r\n  source_specimen_life_stage interaction_type target_taxon_external_id\r\n1                         NA          eatenBy               EOL:507618\r\n2                         NA          eatenBy                EOL:48896\r\n3                         NA          eatenBy               EOL:306722\r\n4                         NA          eatenBy             GBIF:1863088\r\n5                         NA          eatenBy             GBIF:1863088\r\n6                         NA          eatenBy               EOL:306722\r\n          target_taxon_name\r\n1         Eumorpha pandorus\r\n2                     Geina\r\n3 Phyllocnistis vitegenella\r\n4             Darapsa myron\r\n5             Darapsa myron\r\n6 Phyllocnistis vitegenella\r\n                                                                                                             target_taxon_path\r\n1                      Animalia | Arthropoda | Insecta | Lepidoptera | Bombycoidea | Sphingidae | Eumorpha | Eumorpha pandorus\r\n2                                       Animalia | Arthropoda | Insecta | Lepidoptera | Pterophoroidea | Pterophoridae | Geina\r\n3 Animalia | Arthropoda | Insecta | Lepidoptera | Gracillarioidea | Gracillariidae | Phyllocnistis | Phyllocnistis vitegenella\r\n4                                         Animalia | Arthropoda | Insecta | Lepidoptera | Sphingidae | Darapsa | Darapsa myron\r\n5                                         Animalia | Arthropoda | Insecta | Lepidoptera | Sphingidae | Darapsa | Darapsa myron\r\n6 Animalia | Arthropoda | Insecta | Lepidoptera | Gracillarioidea | Gracillariidae | Phyllocnistis | Phyllocnistis vitegenella\r\n  target_specimen_life_stage latitude longitude study_citation\r\n1                         NA       NA        NA             NA\r\n2                         NA       NA        NA             NA\r\n3                         NA       NA        NA             NA\r\n4                         NA       NA        NA             NA\r\n5                         NA       NA        NA             NA\r\n6                         NA       NA        NA             NA\r\n  study_source_citation\r\n1                    NA\r\n2                    NA\r\n3                    NA\r\n4                    NA\r\n5                    NA\r\n6                    NA\r\n```\r\n\r\nAlternatives, you can just use the interactions.tsv.gz or interactions.csv.gz (see https://globalbioticinteractions.org/data) and use your own tools to subset/process  indexed interaction data. This way, you don't have to rely on an internet connection to retrieve results, you can download a copy of interactions.tsv.gz or interactions.csv.gz and work with a stable copy. \r\n\r\nI hope this helps and curious to hear about your outcomes.\r\n\r\n\r\nPS Glad to hear that you are using https://www.globalbioticinteractions.org/2020/08/25/extracting-parasite-interaction-data/ to help share your interaction data. I'll let Stephen Fowler and their advisor Jessica Light https://www.jessicalight.org/ know. Please don't hesitate to reach out if you have suggestions/ comments / questions.\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/896998961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/897012547","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/686#issuecomment-897012547","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/686","id":897012547,"node_id":"IC_kwDOACXQt841d1ND","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T17:27:04Z","updated_at":"2021-08-11T17:29:08Z","body":"Also, I'd welcome datasets by Adriano (the entomologist). \r\n\r\nAs Charles Elton said in his 1927 work \"Animal Ecology\" on page 6 (https://www.biodiversitylibrary.org/page/7236526 ; and Elton, CS. 1927. Animal ecology. https://doi.org/10.5962/bhl.title.7435 ) : \r\n\r\n\"[...] It should always be remembered that the professional ecologist has to rely, and always will have to rely, for a great many of his data, upon the observations of men like fishermen, gamekeepers, local naturalists, and, in fact, all manner of people who are not professional scientists at all. The life, habits, and distribution of animals are often such difficult things to ascertain and so variable from time to time, that it will always be absolutely essential to use the unique knowledge of men who have been studying animals in one place for a good many years. [...]\"\r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/897012547/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/898598245","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/686#issuecomment-898598245","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/686","id":898598245,"node_id":"IC_kwDOACXQt841j4Vl","user":{"login":"bonushenricus","id":62553299,"node_id":"MDQ6VXNlcjYyNTUzMjk5","avatar_url":"https://avatars.githubusercontent.com/u/62553299?v=4","gravatar_id":"","url":"https://api.github.com/users/bonushenricus","html_url":"https://github.com/bonushenricus","followers_url":"https://api.github.com/users/bonushenricus/followers","following_url":"https://api.github.com/users/bonushenricus/following{/other_user}","gists_url":"https://api.github.com/users/bonushenricus/gists{/gist_id}","starred_url":"https://api.github.com/users/bonushenricus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bonushenricus/subscriptions","organizations_url":"https://api.github.com/users/bonushenricus/orgs","repos_url":"https://api.github.com/users/bonushenricus/repos","events_url":"https://api.github.com/users/bonushenricus/events{/privacy}","received_events_url":"https://api.github.com/users/bonushenricus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T17:00:18Z","updated_at":"2021-08-13T17:04:47Z","body":"Thank you!\r\nThis works:\r\n\r\n> `rglobi::query(\"START sourceTaxon = node:taxons(name='Vitis vinifera'),targetTaxon = node:taxonPaths('path:Insecta') MATCH sourceTaxon<-[:CLASSIFIED_AS]-source-[rel:EATEN_BY|HAS_PARASITE]->target-[:CLASSIFIED_AS]->targetTaxon RETURN distinct(targetTaxon.name),type(rel)\")`\r\n\r\nThe problem is the codification of Universal chalcidoidea database in GLOBI: it seems the associated plants are coded as \"HAS PARASITE\", but in the UCD of NHM are simply associated plant, so \"INTERACT_WITH\" (because is difficult to know if is \"POLLINATED BY\").\r\nIs there an easy way to fix this error for all occurrences derived from UCD, for plants? Of course there are cases (the torimids in particular) that are right. But they are few.\r\n\r\nnow in R I have two dataframes, one for our catches, and one for the insects interacting with the vine.\r\nTo test the query I tried to figure out how to make the list from the dataframes.\r\nEg\r\n\r\n> `rglobi::query(\"START sourceTaxon = node:taxons(name='Vitis vinifera'),targetTaxon = node:taxons(name=list('Anagrus','Alamella')) MATCH sourceTaxon<-[:CLASSIFIED_AS]-source-[rel:EATEN_BY|HAS_PARASITE]->target-[:CLASSIFIED_AS]->targetTaxon RETURN distinct(targetTaxon.name),type(rel)\")`\r\n\r\nit does not work.\r\n\r\ncan you give me a little help?\r\n\r\nI try to understand ZENODO for Adriano's data!","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/898598245/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/898658534","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/686#issuecomment-898658534","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/686","id":898658534,"node_id":"IC_kwDOACXQt841kHDm","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T18:56:01Z","updated_at":"2021-08-13T18:56:01Z","body":"@bonushenricus I am glad you found my example useful. \r\n\r\nSome notes/requests:\r\n\r\n1. an example of cypher using multiple lists \r\n```\r\nSTART sourceTaxon = node:taxons(name='Vitis vinifera'),targetTaxon = node:taxonPaths('path:Anagrus path:Alamella') MATCH sourceTaxon<-[:CLASSIFIED_AS]-source-[rel:EATEN_BY|HAS_PARASITE]->target-[:CLASSIFIED_AS]->targetTaxon RETURN distinct(targetTaxon.name),type(rel)\r\n```\r\nYou'll find many great documentation of writing Cypher queries through neo4j.org and related sites. I am sure there's other / better ways to make this happen.\r\n\r\n2. Separating issues in separate issues - in order to help address individual issues, can you please open separate issues for separate concerns. For instance, you mention  \"The problem is the codification of Universal chalcidoidea database in GLOBI: it seems the associated plants are coded as \"HAS PARASITE\", but in the UCD of NHM are simply associated plant, so \"INTERACT_WITH\" (because is difficult to know if is \"POLLINATED BY\").\" next to the cypher query questions. Suggest to create a separate issue for this with specific example and descriptive title. An example can be: issues title: ```unexpected interaction records Universal chalcidoidea database``` with specific links / screenshots to one or two example of unexpected interaction, in addition to what you would expect.\r\n\r\n3. I am note quite sure what you mean by ```I try to understand ZENODO for Adriano's data!```, but I'd be happy to point you to other similar datasets and how they published their data. Again, examples of the data would help, even if it's a screenshot of a excel spreadsheet or limited example containing only 1-2 records.\r\n\r\nThanks for being patient with me as I am trying to find ways to respond to your questions and comments. ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/898658534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]