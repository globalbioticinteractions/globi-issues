[{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/146956987","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/145#issuecomment-146956987","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/145","id":146956987,"node_id":"MDEyOklzc3VlQ29tbWVudDE0Njk1Njk4Nw==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-10-09T18:37:56Z","updated_at":"2015-10-09T18:37:56Z","body":"an example of API based taxon resolution issue; https://github.com/EOL/tramea/issues/24 .\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/146956987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/167703268","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/145#issuecomment-167703268","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/145","id":167703268,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NzcwMzI2OA==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-12-29T02:40:34Z","updated_at":"2015-12-29T17:37:39Z","body":"current name resolving methods provided by naming aggregators such as Encyclopedia of Life, Global Names contain crucial information (e.g. taxonomic classifications, thumbnail images and common names). However, the information retrieval methods provided by these and similar systems pose several challenges when continuously resolving 100k+ names from 70+ data sources. The challenges were:\n1. response time - time to retrieve a single name or a batch of names varies between about 40ms /name (Global Names) and 30+ seconds/ name. Given that many different web apis are used to assure the desired name coverage, support specific name id schemes (e.g. Global Names does not yet support National Biodiversity Networks name ids), link to image thumbnails or common names, the total time needed to retrieve the desired information grew to over 100 hours to resolve the 100k+ names provided by GloBI data sources.\n2. throughput - a commonly used \"netiqette\" is to wait a second in between web api calls to avoid overloading the provided web services. When resolving names one by one (needed for various apis such as EOL API), this leads to a minimum wait time of about 28 hours.\n3. reliability - web APIs often produces intermittent 500 error codes (internal server error due to bugs, lack of resources or timeouts), are unavailable all together due to (un)scheduled maintenance or suffer from (semi-) permanent loss of hosting capacity/skills. If this happens for a prolonged amount of time (> 5 minutes) during a 100+ hr indexing period, an outage caused incomplete name indexes and days of (automated) work needed to be re-run. \n4. versioning - the information retrieved from the web apis is not versioned, meaning that there's no  method to reproduce a name resolution process.\n\nRather than relying on others to provide method to address challenges 1-4, I spent some time to implement a method to make GloBI's name resolution scale to allow for updates to propagate without a couple of days and make the process more predictable. The approach I took was to decouple name resolution from the data ingestion process in addition to publishing a GloBI taxon map and taxon cache. The published taxon map and cache csv files are re-used to speed up taxonomic resolution, while new names are incrementally resolved using the name resolving methods provided by the various apis. Not only does this provide fast and reliable name resolution (>20k names /s), the process can also be repeated using the specific version of the taxon name map/cache archives without relying on external apis (the taxon map and cache are stored as artifacts in [a maven repository](https://maven.apache.org/guides/introduction/introduction-to-repositories.html). This decoupling and archiving approach makes it possible to re-use previously retrieved name resolution results, while still being able to rebuild, or add to, the taxon maps and cache at some later date.\n\nWith the introduction of this versioned name map and taxon cache, GloBI has addressed the core of the challenges 1-4. As GloBI benefits from a more reliable and faster method to make up-to-date species interaction data available, I am hoping that this example leads to discussion within the community on how to better support reproducible workflows to link large data sets to existing naming authorities (e.g. taxonomies, controlled vocabularies, ontologies and associated aggregated datasets).\n\nThese two mentioned name resources contain a mapping from provided name/ids pairs to resolved name/id pairs in addition to a list of resolved taxa and associated data (e.g. common names, thumbnail, taxonomic path, taxonomic ids).\n\nAn example of a taxon map (accessed on Dec 28 2015 at http://globalbioticinteractions.org/references.html > taxonMap.csv.gz):\n\n| providedTaxonId | providedTaxonName | resolvedTaxonId | resolvedTaxonName |\n| --- | --- | --- | --- |\n| \"\" | Graphiurus vulcanicus | EOL:42255 | Graphiurus |\n| \"\" | Graphiurus vulcanicus | OTT:159163 | Graphiurus |\n\nand taxon cache looks like (accessed on Dec 28 2015 at http://globalbioticinteractions.org/references.html > taxonCache.csv.gz):\n\n``` csv\nid,name,rank,commonNames,path,pathIds,pathNames,externalUrl,thumbnailUrl\nEOL:42255,Graphiurus,Genus,African dormice @en | Afrikanunihiiret @fi |,Animalia | Chordata | Mammalia | Rodentia | Myoxidae | Graphiurus,EOL:1 | EOL:694 | EOL:1642 | EOL:8677 | EOL:8699 | EOL:42255,kingdom | phylum | class | order | family | genus,http://eol.org/pages/42255,http://media.eol.org/content/2013/06/17/16/08182_98_68.jpg\nOTT:159163,Graphiurus,genus,,Animalia | Chordata | Mammalia | Rodentia | Gliridae | Graphiurus,IRMNG:11 | IRMNG:148 | IRMNG:1310 | IRMNG:11808 | IRMNG:104259 | IRMNG:1285134,kingdom | phylum | class | order | family | genus,http://eol.org/pages/42255,http://media.eol.org/content/2013/06/17/16/08182_98_68.jpg\n```\n\nSome performance statistics: prior to introduction of naming cache, the resolving 1.3M names (~100k unique name/ids) took about 114 hours (occurred on Sun Dec 13, 2015). After introduction of the name map and cache, this was reduced to about 10-12 hours (range across three runs in period Dec 24-28 2015).\n\n@dimus @jrice @jhammock @cmungall curious to hear your thoughts on how to best communicate these notes (or evolved versions of it) to spur communications within the community.\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/167703268/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]