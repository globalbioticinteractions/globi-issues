[{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/763167878","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/590#issuecomment-763167878","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/590","id":763167878,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzE2Nzg3OA==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T21:57:56Z","updated_at":"2021-01-19T21:57:56Z","body":"Hey Rodrigo - \r\n\r\nThanks for you message. The GloBI API provide a dynamic snapshot into often dynamic datasets that are continually indexed. So, if you are using the API instead of the stable/release GloBI data products (see https://globalbioticinteractions.org/data), changes are expected. \r\n\r\nHowever, I expect most changes to be gradual, so I am curious to hear more about what you've observed:\r\n\r\nCan you please be more specific about the big changes that you've noticed? ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/763167878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/763170072","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/590#issuecomment-763170072","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/590","id":763170072,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzE3MDA3Mg==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T22:02:11Z","updated_at":"2021-01-19T22:58:33Z","body":"I did notice that the indexes were most recently refreshed at Tue Jan 19 21:57:34 CET 2021 .","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/763170072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/763189444","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/590#issuecomment-763189444","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/590","id":763189444,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzE4OTQ0NA==","user":{"login":"Rodrigo-A-Pereira","id":69594660,"node_id":"MDQ6VXNlcjY5NTk0NjYw","avatar_url":"https://avatars.githubusercontent.com/u/69594660?v=4","gravatar_id":"","url":"https://api.github.com/users/Rodrigo-A-Pereira","html_url":"https://github.com/Rodrigo-A-Pereira","followers_url":"https://api.github.com/users/Rodrigo-A-Pereira/followers","following_url":"https://api.github.com/users/Rodrigo-A-Pereira/following{/other_user}","gists_url":"https://api.github.com/users/Rodrigo-A-Pereira/gists{/gist_id}","starred_url":"https://api.github.com/users/Rodrigo-A-Pereira/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rodrigo-A-Pereira/subscriptions","organizations_url":"https://api.github.com/users/Rodrigo-A-Pereira/orgs","repos_url":"https://api.github.com/users/Rodrigo-A-Pereira/repos","events_url":"https://api.github.com/users/Rodrigo-A-Pereira/events{/privacy}","received_events_url":"https://api.github.com/users/Rodrigo-A-Pereira/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T22:40:26Z","updated_at":"2021-01-19T22:40:26Z","body":"Hi @jhpoelen thanks for the quick reply :)\r\n\r\nI am working mostly with \"hasHost\" interaction types. The most notable changes i have noticed, are:\r\n\r\nThe difference in \"targets\" returned. Taking as an example the NCBI:418103 (wich is one of the few entities i have a JSON response of the \"old\" api), the intersection between the old results and new results (this intersection was made taking into account \"target_taxon_name\" and \"target_taxon_external_id\") is only of 11 out of the 298 and 878 unique entities of both the old and new responses respecively. \r\n\r\nAdditionally i also noticed that there was a large introduction of entities with no match to external databases (EOL, NCBI, etc ), with the old api returning 15 entities with \"no:match\" on the \"target_taxon_external_id\" field , while the new api returns 652 such entities.\r\n\r\n\r\nOnce again thank you so much for the quick reply,\r\n\r\nBest regards,\r\nRodrigo Pereira","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/763189444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/763194492","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/590#issuecomment-763194492","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/590","id":763194492,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzE5NDQ5Mg==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T22:52:38Z","updated_at":"2021-01-19T22:52:38Z","body":"Thanks for providing more details on the changes you noticed. Can you please include the before and after data in text format? This way, I can go over the changes in more details and figure out whether the behavior is expected or not.\r\n\r\nThanks for being patient.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/763194492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/763206434","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/590#issuecomment-763206434","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/590","id":763206434,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzIwNjQzNA==","user":{"login":"Rodrigo-A-Pereira","id":69594660,"node_id":"MDQ6VXNlcjY5NTk0NjYw","avatar_url":"https://avatars.githubusercontent.com/u/69594660?v=4","gravatar_id":"","url":"https://api.github.com/users/Rodrigo-A-Pereira","html_url":"https://github.com/Rodrigo-A-Pereira","followers_url":"https://api.github.com/users/Rodrigo-A-Pereira/followers","following_url":"https://api.github.com/users/Rodrigo-A-Pereira/following{/other_user}","gists_url":"https://api.github.com/users/Rodrigo-A-Pereira/gists{/gist_id}","starred_url":"https://api.github.com/users/Rodrigo-A-Pereira/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rodrigo-A-Pereira/subscriptions","organizations_url":"https://api.github.com/users/Rodrigo-A-Pereira/orgs","repos_url":"https://api.github.com/users/Rodrigo-A-Pereira/repos","events_url":"https://api.github.com/users/Rodrigo-A-Pereira/events{/privacy}","received_events_url":"https://api.github.com/users/Rodrigo-A-Pereira/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T23:21:19Z","updated_at":"2021-01-19T23:22:09Z","body":"Sure, here are the old and new versions of response of the two entites i still have the response from the old API ( NCBI:418103 and NCBI:6231).\r\n\r\n[newNCBI6231.txt](https://github.com/globalbioticinteractions/globalbioticinteractions/files/5839157/newNCBI6231.txt)\r\n[newNCBI418103.txt](https://github.com/globalbioticinteractions/globalbioticinteractions/files/5839158/newNCBI418103.txt)\r\n[oldNCBI6231.txt](https://github.com/globalbioticinteractions/globalbioticinteractions/files/5839159/oldNCBI6231.txt)\r\n[oldNCBI418103.txt](https://github.com/globalbioticinteractions/globalbioticinteractions/files/5839160/oldNCBI418103.txt)\r\n\r\n\r\nHere is also the python code i used to obtain the statistics i gave in my previous message, if it is usefull (needs to convert attached files to json format since Github does not accept json files):\r\n\r\n```\r\nimport pandas as pd\r\nimport json\r\n\r\n#Load Json files\r\noldf = open('oldNCBI418103.json') \r\nnewf = open('newNCBI418103.json')\r\noldJson=json.load(oldf)\r\nnewJson=json.load(newf)\r\n\r\n##Old response statistics\r\nolddf=pd.DataFrame(oldJson[\"data\"], columns=oldJson[\"columns\"])\r\nolddf=olddf[[\"interaction_type\",\"target_taxon_name\",\"target_taxon_external_id\"]].sort_values(by=['target_taxon_name']).drop_duplicates()\r\n\r\nprint(f\"Number of unique rows in old response: {olddf.shape[0]}\")\r\nprint(\"Number of 'no:match' in old response: {0}\".format(olddf[olddf['target_taxon_external_id']==\"no:match\"].shape[0]))\r\n\r\n##New response statistics\r\nnewdf=pd.DataFrame(newJson[\"data\"], columns=newJson[\"columns\"])\r\nnewdf=newdf[[\"interaction_type\",\"target_taxon_name\",\"target_taxon_external_id\"]].sort_values(by=['target_taxon_name']).drop_duplicates()\r\n\r\nprint(f\"Number of unique rows in old response: {newdf.shape[0]}\")\r\nprint(\"Number of 'no:match' in new response: {0}\".format(newdf[newdf['target_taxon_external_id']==\"no:match\"].shape[0]))\r\n\r\n##Intersection\r\nprint(\"Intersected entities: {0}\".format(olddf.merge(newdf, how = 'outer' ,indicator=True).loc[lambda x : x['_merge']=='both'].shape[0]))\r\n```\r\n\r\n\r\n\r\n\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/763206434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/763209756","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/590#issuecomment-763209756","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/590","id":763209756,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzIwOTc1Ng==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T23:29:35Z","updated_at":"2021-01-19T23:29:35Z","body":"Thanks for providing the details Rodrigo! Hoping to get back to this soon. If you don't hear from me soon, please feel free to remind me!","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/763209756/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/780912999","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/590#issuecomment-780912999","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/590","id":780912999,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDkxMjk5OQ==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T23:05:49Z","updated_at":"2021-02-17T23:07:04Z","body":"Hi @Rodrigo-A-Pereira -\r\n\r\nI had another look at your reported issues. The root cause is not necessarily that the results changed, but that the ordering of the results is not guaranteed. Also, you are hitting the request page limits of 1024. \r\n\r\nSo, in order to compare results, you have to 1. retrieve *all* results using pagination (see https://github.com/globalbioticinteractions/globalbioticinteractions/wiki/API#pagination ) and then 2. sort the results before comparing them. \r\n\r\nFor your examples oldNCBI6231 and newNCBI6231 I confirm that you were hitting the page limits by counting the individual data rows for the json results using:\r\n\r\n```\r\n$ curl -L \"https://github.com/globalbioticinteractions/globalbioticinteractions/files/5839159/oldNCBI6231.txt\" | jq -c .data[] | wc -l\r\n1024\r\n```\r\nand \r\n\r\n```\r\n$ curl -L \"https://github.com/globalbioticinteractions/globalbioticinteractions/files/5839157/newNCBI6231.txt\" | jq -c .data[] | wc -l\r\n1024\r\n```\r\n\r\nTo avoid having the use page limits, you can just get all the data via ```interactions.tsv.gz``` at https://globalbioticinteractions.org/data and filter down the results to suit your research. If you choose the use the stable data, you won't have to worry about updates.  \r\n\r\nAlternatively, if you decided to stick with the web api, you'll have to page through all the results until no more rows are generated. See https://github.com/globalbioticinteractions/globalbioticinteractions/wiki/API#pagination for more information on that. \r\n\r\nI believe that resolves your issue. Please comment / re-open if this is not the case.\r\n\r\nThanks for reporting the issue and for being patient. I am curious to hear how you'll end up using the rich species interactions datasets provided by the many GloBI data sources https://globalbioticinteractions.org/sources . ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/780912999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/782025992","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/590#issuecomment-782025992","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/590","id":782025992,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjAyNTk5Mg==","user":{"login":"Rodrigo-A-Pereira","id":69594660,"node_id":"MDQ6VXNlcjY5NTk0NjYw","avatar_url":"https://avatars.githubusercontent.com/u/69594660?v=4","gravatar_id":"","url":"https://api.github.com/users/Rodrigo-A-Pereira","html_url":"https://github.com/Rodrigo-A-Pereira","followers_url":"https://api.github.com/users/Rodrigo-A-Pereira/followers","following_url":"https://api.github.com/users/Rodrigo-A-Pereira/following{/other_user}","gists_url":"https://api.github.com/users/Rodrigo-A-Pereira/gists{/gist_id}","starred_url":"https://api.github.com/users/Rodrigo-A-Pereira/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rodrigo-A-Pereira/subscriptions","organizations_url":"https://api.github.com/users/Rodrigo-A-Pereira/orgs","repos_url":"https://api.github.com/users/Rodrigo-A-Pereira/repos","events_url":"https://api.github.com/users/Rodrigo-A-Pereira/events{/privacy}","received_events_url":"https://api.github.com/users/Rodrigo-A-Pereira/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T11:47:41Z","updated_at":"2021-02-19T11:47:41Z","body":"Hi @jhpoelen, thank you for replying. \r\nI ended up using the `interactions.tsv.gz` like u sugested given its stability.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/782025992/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]