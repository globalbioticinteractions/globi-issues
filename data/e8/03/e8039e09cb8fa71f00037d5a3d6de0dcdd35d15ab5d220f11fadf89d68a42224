[{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/1317143564","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/844#issuecomment-1317143564","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/844","id":1317143564,"node_id":"IC_kwDOACXQt85OggQM","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-11-16T14:51:08Z","updated_at":"2022-11-16T14:51:57Z","body":"@BarbaraMeulenbelt thanks for sharing the details on the unexpected behavior.\r\n\r\nNote that \r\n\r\n```\r\ngrep \"GBIF:.GBIF:.\"\r\n```\r\n\r\nmatches only things like:\r\n\r\nGBIF:XGBIF:Y\r\n\r\nwhereas,\r\n\r\n```\r\ngrep \"GBIF:.*GBIF:.*\"\r\n```\r\n\r\nmatches things like:\r\n\r\n```GBIF:[some long string]GBIF:[some other long string]```\r\n\r\n\r\nIn other words, in grep-land a ```.``` matches a single character , and ```.*``` matches many characters .\r\n\r\nCan you repeat the script with the ```.*``` match patterns? ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/1317143564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/1317157181","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/844#issuecomment-1317157181","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/844","id":1317157181,"node_id":"IC_kwDOACXQt85Ogjk9","user":{"login":"BarbaraMeulenbelt","id":38956533,"node_id":"MDQ6VXNlcjM4OTU2NTMz","avatar_url":"https://avatars.githubusercontent.com/u/38956533?v=4","gravatar_id":"","url":"https://api.github.com/users/BarbaraMeulenbelt","html_url":"https://github.com/BarbaraMeulenbelt","followers_url":"https://api.github.com/users/BarbaraMeulenbelt/followers","following_url":"https://api.github.com/users/BarbaraMeulenbelt/following{/other_user}","gists_url":"https://api.github.com/users/BarbaraMeulenbelt/gists{/gist_id}","starred_url":"https://api.github.com/users/BarbaraMeulenbelt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BarbaraMeulenbelt/subscriptions","organizations_url":"https://api.github.com/users/BarbaraMeulenbelt/orgs","repos_url":"https://api.github.com/users/BarbaraMeulenbelt/repos","events_url":"https://api.github.com/users/BarbaraMeulenbelt/events{/privacy}","received_events_url":"https://api.github.com/users/BarbaraMeulenbelt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-11-16T14:59:34Z","updated_at":"2022-11-16T14:59:46Z","body":"Hi Jorrit, sorry that was a typo \r\n\r\n> cat interactions.csv.gz\\\r\n> | gunzip\\\r\n> | mlr --icsv --otsvlite cut -f sourceTaxonId,sourceTaxonName,sourceTaxonRank,interactionTypeName,targetTaxonId,targetTaxonName,targetTaxonRank\\\r\n> | nomer replace --properties replace-source.properties gbif\\\r\n> | nomer replace --properties replace-target.properties gbif\\\r\n> | grep “GBIF:.*GBIF:.*”\\\r\n>  >  gbif-id-name-interaction-id-name.tsv\r\n\r\nThis is the right code","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/1317157181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/1317160982","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/844#issuecomment-1317160982","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/844","id":1317160982,"node_id":"IC_kwDOACXQt85OgkgW","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-11-16T15:02:06Z","updated_at":"2022-11-16T15:02:06Z","body":"@BarbaraMeulenbelt thanks for the update. \r\n\r\nCan you please include the replace-target.properties and reaplce-source.properties files, so I can try and reproduce your unexpected results?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/1317160982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/1317165279","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/844#issuecomment-1317165279","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/844","id":1317165279,"node_id":"IC_kwDOACXQt85Ogljf","user":{"login":"BarbaraMeulenbelt","id":38956533,"node_id":"MDQ6VXNlcjM4OTU2NTMz","avatar_url":"https://avatars.githubusercontent.com/u/38956533?v=4","gravatar_id":"","url":"https://api.github.com/users/BarbaraMeulenbelt","html_url":"https://github.com/BarbaraMeulenbelt","followers_url":"https://api.github.com/users/BarbaraMeulenbelt/followers","following_url":"https://api.github.com/users/BarbaraMeulenbelt/following{/other_user}","gists_url":"https://api.github.com/users/BarbaraMeulenbelt/gists{/gist_id}","starred_url":"https://api.github.com/users/BarbaraMeulenbelt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BarbaraMeulenbelt/subscriptions","organizations_url":"https://api.github.com/users/BarbaraMeulenbelt/orgs","repos_url":"https://api.github.com/users/BarbaraMeulenbelt/repos","events_url":"https://api.github.com/users/BarbaraMeulenbelt/events{/privacy}","received_events_url":"https://api.github.com/users/BarbaraMeulenbelt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-11-16T15:05:01Z","updated_at":"2022-11-16T15:05:01Z","body":"Yep.  \r\n\r\nreplace-source.properties:\r\n\r\n> nomer.schema.input=[{\"column\": 1,\"type\":\"name\"}]\r\n> nomer.schema.output=[{\"column\":0,\"type\":\"externalId\"},{\"column\": 1,\"type\":\"name\"}]\r\n\r\n\r\nreplace-target.properties:\r\n\r\n> nomer.schema.input=[{\"column\": 5,\"type\":\"name\"}]\r\n> nomer.schema.output=[{\"column\":4,\"type\":\"externalId\"},{\"column\": 5,\"type\":\"name\"}]\r\n\r\n\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/1317165279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/1317205376","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/844#issuecomment-1317205376","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/844","id":1317205376,"node_id":"IC_kwDOACXQt85OgvWA","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-11-16T15:31:15Z","updated_at":"2022-11-16T15:43:25Z","body":"In attempting to reproduce:\r\n\r\n1. check if source data has at least two records\r\n```\r\n cat /home/bameulenbelt/interactions.csv.gz | gunzip | head -n2 \r\nsourceTaxonId,sourceTaxonIds,sourceTaxonName,sourceTaxonRank,sourceTaxonPathNames,sourceTaxonPathIds,sourceTaxonPathRankNames,sourceTaxonSpeciesName,sourceTaxonSpeciesId,sourceTaxonSubgenusName,sourceTaxonSubgenusId,sourceTaxonGenusName,sourceTaxonGenusId,sourceTaxonFamilyName,sourceTaxonFamilyId,sourceTaxonOrderName,sourceTaxonOrderId,sourceTaxonClassName,sourceTaxonClassId,sourceTaxonPhylumName,sourceTaxonPhylumId,sourceTaxonKingdomName,sourceTaxonKingdomId,sourceId,sourceOccurrenceId,sourceInstitutionCode,sourceCollectionCode,sourceCatalogNumber,sourceBasisOfRecordId,sourceBasisOfRecordName,sourceLifeStageId,sourceLifeStageName,sourceBodyPartId,sourceBodyPartName,sourcePhysiologicalStateId,sourcePhysiologicalStateName,sourceSexId,sourceSexName,interactionTypeName,interactionTypeId,targetTaxonId,targetTaxonIds,targetTaxonName,targetTaxonRank,targetTaxonPathNames,targetTaxonPathIds,targetTaxonPathRankNames,targetTaxonSpeciesName,targetTaxonSpeciesId,targetTaxonSubgenusName,targetTaxonSubgenusId,targetTaxonGenusName,targetTaxonGenusId,targetTaxonFamilyName,targetTaxonFamilyId,targetTaxonOrderName,targetTaxonOrderId,targetTaxonClassName,targetTaxonClassId,targetTaxonPhylumName,targetTaxonPhylumId,targetTaxonKingdomName,targetTaxonKingdomId,targetId,targetOccurrenceId,targetInstitutionCode,targetCollectionCode,targetCatalogNumber,targetBasisOfRecordId,targetBasisOfRecordName,targetLifeStageId,targetLifeStageName,targetBodyPartId,targetBodyPartName,targetPhysiologicalStateId,targetPhysiologicalStateName,targetSexId,targetSexName,decimalLatitude,decimalLongitude,localityId,localityName,eventDate,argumentTypeId,referenceCitation,referenceDoi,referenceUrl,sourceCitation,sourceNamespace,sourceArchiveURI,sourceDOI,sourceLastSeenAtUnixEpoch\r\nEOL:28028,EOL:28028 | GBIF:1460943 | GBIF:1460950 | IRMNG:1347016 | ITIS:650655 | ITIS:652101 | WD:Q4037687,Winthemia,genus,Animalia | Arthropoda | Insecta | Diptera | Tachinidae | Winthemia,EOL:1 | EOL:164 | EOL:344 | EOL:421 | EOL:9019 | EOL:28028,kingdom | phylum | class | order | family | genus,,,,,Winthemia,EOL:28028,Tachinidae,EOL:9019,Diptera,EOL:421,Insecta,EOL:344,Arthropoda,EOL:164,Animalia,EOL:1,,,,,,,,,,,,,,,,parasiteOf,http://purl.obolibrary.org/obo/RO_0002444,GBIF:1867029,GBIF:1867029 | INAT_TAXON:81583 | IRMNG:11395340 | IRMNG:11413849 | ITIS:936186 | WD:Q2131585,Anisota senatoria,species,Animalia | Arthropoda | Insecta | Lepidoptera | Saturniidae | Anisota | Anisota senatoria,GBIF:1 | GBIF:54 | GBIF:216 | GBIF:797 | GBIF:8864 | GBIF:1867018 | GBIF:1867029,kingdom | phylum | class | order | family | genus | species,Anisota senatoria,GBIF:1867029,,,Anisota,GBIF:1867018,Saturniidae,GBIF:8864,Lepidoptera,GBIF:797,Insecta,GBIF:216,Arthropoda,GBIF:54,Animalia,GBIF:1,,,,,,,,,,,,,,,,,,,North America,,https://en.wiktionary.org/wiki/support,\"Arnaud, Paul Henri. A Host-parasite Catalog of North American Tachinidae (Diptera). Washington, D.C.: U.S. Dept. of Agriculture, Science and Education Administration, 1978.\",,,\"Sarah E Miller. 5/28/2015. Arnaud, Paul Henri. A Host-parasite Catalog of North American Tachinidae (Diptera). Washington, D.C.: U.S. Dept. of Agriculture, Science and Education Administration, 1978.\",millerse/A-Host-parasite-Catalog-of-North-American-Tachinidae-Diptera-,https://zenodo.org/record/258186/files/millerse/A-Host-parasite-Catalog-of-North-American-Tachinidae-Diptera--v1.0.zip,10.5281/zenodo.258186,2022-11-06T09:00:14.106Z\r\n```\r\n\r\n2. same, but then with mlr added -\r\n\r\n```\r\n$ cat /home/bameulenbelt/interactions.csv.gz | gunzip | mlr --icsv --otsvlite cut -f sourceTaxonId,sourceTaxonName,sourceTaxonRank,interactionTypeName,targetTaxonId,targetTaxonName,targetTaxonRank | head -n2\r\nsourceTaxonId\tsourceTaxonName\tsourceTaxonRank\tinteractionTypeName\ttargetTaxonId\ttargetTaxonName\ttargetTaxonRank\r\nEOL:28028\tWinthemia\tgenus\tparasiteOf\tGBIF:1867029\tAnisota senatoria\tspecies\r\n```\r\n\r\n3. now add nomer for source replacement\r\n\r\n```\r\ncat /home/bameulenbelt/interactions.csv.gz | gunzip | mlr --icsv --otsvlite cut -f sourceTaxonId,sourceTaxonName,sourceTaxonRank,interactionTypeName,targetTaxonId,targetTaxonName,targetTaxonRank | nomer replace --properties replace-source.properties gbif | head -n2\r\n```\r\n\r\nyields:\r\n\r\n```\r\n[main] INFO org.globalbioticinteractions.nomer.match.TermMatcherRegistry - using matcher [gbif-taxon]\r\n[main] INFO org.globalbioticinteractions.nomer.match.GBIFTaxonService - GBIF taxonomy ids already indexed at [/home/jhpoelen/.cache/nomer/gbif/gbif], no need to import.\r\n\tsourceTaxonName\tsourceTaxonRank\tinteractionTypeName\ttargetTaxonId\ttargetTaxonName\ttargetTaxonRank\r\nGBIF:1460943\tWinthemia\tgenus\tparasiteOf\tGBIF:1867029\tAnisota senatoria\tspecies\r\n```\r\n\r\n3. in addition, add target replacement\r\n\r\n```\r\ncat /home/bameulenbelt/interactions.csv.gz | gunzip | mlr --icsv --otsvlite cut -f sourceTaxonId,sourceTaxonName,sourceTaxonRank,interactionTypeName,targetTaxonId,targetTaxonName,targetTaxonRank | nomer replace --properties replace-source.properties gbif | nomer replace --properties replace-target.properties gbif | head -n2\r\n```\r\n\r\nyields\r\n```\r\n[main] INFO org.globalbioticinteractions.nomer.match.TermMatcherRegistry - using matcher [gbif-taxon]\r\n[main] INFO org.globalbioticinteractions.nomer.match.TermMatcherRegistry - using matcher [gbif-taxon]\r\n[main] INFO org.globalbioticinteractions.nomer.match.GBIFTaxonService - GBIF taxonomy ids already indexed at [/home/jhpoelen/.cache/nomer/gbif/gbif], no need to import.\r\n[main] INFO org.globalbioticinteractions.nomer.match.GBIFTaxonService - GBIF taxonomy ids already indexed at [/home/jhpoelen/.cache/nomer/gbif/gbif], no need to import.\r\n\tsourceTaxonName\tsourceTaxonRank\tinteractionTypeName\t\ttargetTaxonName\ttargetTaxonRank\r\nGBIF:1460943\tWinthemia\tgenus\tparasiteOf\tGBIF:1867029\tAnisota senatoria\tspecies\r\n```\r\n\r\nSo, I was able to produce at least one line with two gbif replacements in it, without the grep expression.\r\n\r\n4. Adding the grep expression as provided above \r\n\r\n```\r\ncat /home/bameulenbelt/interactions.csv.gz | gunzip | mlr --icsv --otsvlite cut -f sourceTaxonId,sourceTaxonName,sourceTaxonRank,interactionTypeName,targetTaxonId,targetTaxonName,targetTaxonRank | nomer replace --properties replace-source.properties gbif | nomer replace --properties replace-target.properties gbif | grep \"GBIF:.GBIF:.\" |  head -n2\r\n```\r\n\r\nyields . . . no results.\r\n\r\nHowever, when replacing the grep expression with ```grep \"GBIF:.*GBIF:.*\"``` (note the ```*```), I see the following appear:\r\n\r\n```\r\nGBIF:1460943\tWinthemia\tgenus\tparasiteOf\tGBIF:1867029\tAnisota senatoria\tspecies\r\nGBIF:1464295\tBlepharipa pratensis\tspecies\tparasiteOf\tGBIF:1759552\tLithophane\tgenus\r\n```\r\n\r\n\r\n@BarbaraMeulenbelt I think this suggests that the grep expression is causing the issue. Please confirm that you can reproduce my steps above. \r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/1317205376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]