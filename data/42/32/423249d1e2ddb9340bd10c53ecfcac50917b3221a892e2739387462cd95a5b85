[{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/937224029","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/710#issuecomment-937224029","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/710","id":937224029,"node_id":"IC_kwDOACXQt8433Odd","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-06T22:00:03Z","updated_at":"2021-10-06T22:00:03Z","body":"From cypher-shell :\r\n\r\n```\r\nneo4j> start taxon = node:taxonPaths('path:\\\"Orchopeas fulleri\\\"') match taxon<-[:CLASSIFIED_AS]-specimen<-[:COLLECTED]-study-[:IN_DATASET]->dataset, specimen-[:ECTOPARASITE_OF]->host where specimen.externalId=\"8278596f-4d3f-4f82-8cd1-b5070fe1bc7c\" return study.externalId, specimen.externalId, specimen.catalogNumber, host;\r\n+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n| study.externalId                                                  | specimen.externalId                    | specimen.catalogNumber | host                                                              |\r\n+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n| \"https://db.fieldmuseum.org/44c14fd7-48cf-457c-a67d-925ebfbb00ac\" | \"8278596f-4d3f-4f82-8cd1-b5070fe1bc7c\" | \"FMNHINS 0004 355 428\" | ({type: \"SpecimenNode\", basisOfRecordLabel: \"PreservedSpecimen\"}) |\r\n+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n```\r\n\r\nthe specimen id is the expected 8278596f-4d3f-4f82-8cd1-b5070fe1bc7c, however, the study.externalId appears to be the unexpected https://db.fieldmuseum.org/44c14fd7-48cf-457c-a67d-925ebfbb00ac .","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/937224029/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/937357206","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/710#issuecomment-937357206","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/710","id":937357206,"node_id":"IC_kwDOACXQt8433u-W","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-07T00:52:02Z","updated_at":"2021-10-07T00:52:02Z","body":"Root cause of the issue appeared to be an indexing issue: the externalId of the reference was not used for indexing, and because the (deprecated) reference titles (aka reference ids) where the same for ```https://db.fieldmuseum.org/44c14fd7-48cf-457c-a67d-925ebfbb00ac``` and ```https://db.fieldmuseum.org/8278596f-4d3f-4f82-8cd1-b5070fe1bc7c```, all specimen where attached to the first reference with that matching reference title. This first reference was the bat fly specimen (https://db.fieldmuseum.org/44c14fd7-48cf-457c-a67d-925ebfbb00ac), because the line preceding the indexed interaction was the header:\r\n\r\n```\r\n$ curl --silent \"https://depot.globalbioticinteractions.org/reviews/globalbioticinteractions/fmnh/indexed-interactions.tsv.gz\" | gunzip | grep --before 5 \"44c14fd7-48cf-457c-a67d-925ebfbb00ac\"\r\nargumentTypeId\tsourceOccurrenceId\tsourceCatalogNumber\tsourceCollectionCode\tsourceCollectionId\tsourceInstitutionCode\tsourceTaxonId\tsourceTaxonName\tsourceTaxonRank\tsourceTaxonPathIds\tsourceTaxonPath\tsourceTaxonPathNames\tsourceBodyPartId\tsourceBodyPartName\tsourceLifeStageId\tsourceLifeStageName\tsourceSexId\tsourceSexName\tinteractionTypeId\tinteractionTypeName\ttargetOccurrenceId\ttargetCatalogNumber\ttargetCollectionCode\ttargetCollectionId\ttargetInstitutionCode\ttargetTaxonId\ttargetTaxonName\ttargetTaxonRank\ttargetTaxonPathIds\ttargetTaxonPath\ttargetTaxonPathNames\ttargetBodyPartId\ttargetBodyPartName\ttargetLifeStageIdtargetLifeStageName\ttargetSexId\ttargetSexName\tbasisOfRecordId\tbasisOfRecordName\thttp://rs.tdwg.org/dwc/terms/eventDate\tdecimalLatitude\tdecimalLongitude\tlocalityId\tlocalityName\treferenceDoi\treferenceUrl\treferenceCitation\tnamespace\tcitation\tarchiveURI\tlastSeenAt\tcontentHash\teltonVersion\r\nhttps://en.wiktionary.org/wiki/support\t44c14fd7-48cf-457c-a67d-925ebfbb00ac\tFMNHINS 0000 371 132\tInsects\tInsects\tFMNH\t\tHippoboscoidea\t\t\tAnimalia | Arthropoda | Insecta | Diptera\tkingdom | phylum | class | order\t\t\t\t\t\t\thttp://purl.obolibrary.org/obo/RO_0002632\tectoparasiteOf\t26062\t\t\t\t\t\tArtibeus\t\t\t\t\t\t\t\tPreservedSpecimen\t\t\t\t\tI.I.C.A. Turrialba\t\t\tField Museum of Natural History (Zoology) Insect, Arachnid and Myriapod Collection - Version 12.41. Accessed at <https://fmipt.fieldmuseum.org/ipt/archive.do?r=fmnh_insects> on 04 Oct 2021.\tglobalbioticinteractions/fmnh\tField Museum of Natural History (Zoology) Insect, Arachnid and Myriapod Collection - Version 12.41\thttps://fmipt.fieldmuseum.org/ipt/archive.do?r=fmnh_insects\t2021-10-01T23:08:02.849Z\t25111154827fb231302fa63547ac7b5a992850097ecf7855642517dec63cde04\t0.12.0\r\n```\r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/937357206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/937838311","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/710#issuecomment-937838311","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/710","id":937838311,"node_id":"IC_kwDOACXQt8435kbn","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-07T14:17:26Z","updated_at":"2021-10-07T14:17:26Z","body":"after the changes propagated, the expected results are produced via\r\n\r\n```\r\nneo4j> start taxon = node:taxonPaths('path:\\\"Orchopeas fulleri\\\"') match taxon<-[:CLASSIFIED_AS]-specimen<-[:COLLECTED]-study-[:IN_DATASET]->dataset, specimen-[:ECTOPARASITE_OF]->host where specimen.externalId=\"8278596f-4d3f-4f82-8cd1-b5070fe1bc7c\" return study.externalId, specimen.externalId, specimen.catalogNumber, host;\r\n+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n| study.externalId                                                  | specimen.externalId                    | specimen.catalogNumber | host                                                              |\r\n+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n| \"https://db.fieldmuseum.org/8278596f-4d3f-4f82-8cd1-b5070fe1bc7c\" | \"8278596f-4d3f-4f82-8cd1-b5070fe1bc7c\" | \"FMNHINS 0004 355 428\" | ({type: \"SpecimenNode\", basisOfRecordLabel: \"PreservedSpecimen\"}) |\r\n+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n```\r\n\r\nand \r\n\r\nHowever, https://www.globalbioticinteractions.org/?accordingTo=https%3A%2F%2Fdb.fieldmuseum.org%2F8278596f-4d3f-4f82-8cd1-b5070fe1bc7c&interactionType=interactsWith appears to still link to a non-related specimen, currently pointing to https://db.fieldmuseum.org/74722b3b-40e9-4ac4-a7ce-875f8cd227c7 . \r\n\r\n![Screenshot from 2021-10-07 07-16-29](https://user-images.githubusercontent.com/1084872/136403064-ae7f4b90-06f8-4d06-a5e9-9aadbcb9740d.png)\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/937838311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/937858411","html_url":"https://github.com/globalbioticinteractions/globalbioticinteractions/issues/710#issuecomment-937858411","issue_url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/710","id":937858411,"node_id":"IC_kwDOACXQt8435pVr","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-07T14:39:34Z","updated_at":"2021-10-07T14:39:34Z","body":"After updating the web search ui to include study_url as a composite key, the expected results appear. This result includes, among many other specimen references, a reference to a specimen with occurrence id (and related resolver link). 8278596f-4d3f-4f82-8cd1-b5070fe1bc7c, https://db.fieldmuseum.org/8278596f-4d3f-4f82-8cd1-b5070fe1bc7c See attached screenshot.\r\n\r\n![Screenshot from 2021-10-07 07-36-43](https://user-images.githubusercontent.com/1084872/136406726-5154e620-e2b8-47de-8a3b-c3f77edccbed.png)\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/globalbioticinteractions/issues/comments/937858411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]